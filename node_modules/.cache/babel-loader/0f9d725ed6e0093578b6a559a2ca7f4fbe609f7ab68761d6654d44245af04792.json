{"ast":null,"code":"var _jsxFileName = \"/Users/chestonopsasnick/Documents/Coding_Projects/DeltsDineV2/client/src/utils/ProtectedRoutes.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from 'react';\nimport { Outlet, Navigate } from \"react-router-dom\";\nimport { useValidation } from './ValidationContext'; // Import the useValidation hook\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction ProtectedRoutes() {\n  _s();\n  const {\n    validated\n  } = useValidation();\n  console.log(\"protected routes \" + validated);\n  // Handle loading state if validation is still being checked\n\n  if (validated === null) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: \"Loading...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 11,\n      columnNumber: 16\n    }, this); // replace with loading ui\n  }\n  const checkBackendValidation = async () => {\n    try {\n      const res = await fetch('http://localhost:3001/api/validation');\n      if (!res.ok) {\n        throw new Error(`HTTP error, Status: ${res.status}`);\n      }\n      const data = await res.json();\n      if (data.isAuthenticated) {\n        setValidatedWithExpiration(true);\n      } else {\n        localStorage.removeItem('validated');\n        setValidated(false);\n      }\n    } catch (err) {\n      console.error('Error fetching validation data:', err);\n      setValidated(false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: validated ? /*#__PURE__*/_jsxDEV(Outlet, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 34,\n      columnNumber: 26\n    }, this) : /*#__PURE__*/_jsxDEV(Navigate, {\n      to: \"/login\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 34,\n      columnNumber: 38\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 33,\n    columnNumber: 9\n  }, this);\n}\n_s(ProtectedRoutes, \"HDszmx3fJpzDkJZm2B2vSHALeQo=\", false, function () {\n  return [useValidation];\n});\n_c = ProtectedRoutes;\nexport default ProtectedRoutes;\nvar _c;\n$RefreshReg$(_c, \"ProtectedRoutes\");","map":{"version":3,"names":["React","useEffect","useState","Outlet","Navigate","useValidation","jsxDEV","_jsxDEV","ProtectedRoutes","_s","validated","console","log","children","fileName","_jsxFileName","lineNumber","columnNumber","checkBackendValidation","res","fetch","ok","Error","status","data","json","isAuthenticated","setValidatedWithExpiration","localStorage","removeItem","setValidated","err","error","to","_c","$RefreshReg$"],"sources":["/Users/chestonopsasnick/Documents/Coding_Projects/DeltsDineV2/client/src/utils/ProtectedRoutes.js"],"sourcesContent":["import React, {useEffect, useState} from 'react'\nimport { Outlet, Navigate } from \"react-router-dom\";\nimport { useValidation } from './ValidationContext'; // Import the useValidation hook\n\nfunction ProtectedRoutes() {\n    const {validated} = useValidation();\n    console.log(\"protected routes \" + validated);\n    // Handle loading state if validation is still being checked\n\n    if (validated === null) {\n        return <div>Loading...</div>; // replace with loading ui\n    }\n    const checkBackendValidation = async () => {\n        try {\n          const res = await fetch('http://localhost:3001/api/validation');\n          if (!res.ok) {\n            throw new Error(`HTTP error, Status: ${res.status}`);\n          }\n          const data = await res.json();\n          if (data.isAuthenticated) {\n            setValidatedWithExpiration(true);\n          } else {\n            localStorage.removeItem('validated');\n            setValidated(false);\n          }\n        } catch (err) {\n          console.error('Error fetching validation data:', err);\n          setValidated(false);\n        }\n      };\n    \n    return (\n        <div>\n            {validated ? <Outlet/> : <Navigate to=\"/login\"/>}\n        </div>\n    )\n}\nexport default ProtectedRoutes"],"mappings":";;AAAA,OAAOA,KAAK,IAAGC,SAAS,EAAEC,QAAQ,QAAO,OAAO;AAChD,SAASC,MAAM,EAAEC,QAAQ,QAAQ,kBAAkB;AACnD,SAASC,aAAa,QAAQ,qBAAqB,CAAC,CAAC;AAAA,SAAAC,MAAA,IAAAC,OAAA;AAErD,SAASC,eAAeA,CAAA,EAAG;EAAAC,EAAA;EACvB,MAAM;IAACC;EAAS,CAAC,GAAGL,aAAa,CAAC,CAAC;EACnCM,OAAO,CAACC,GAAG,CAAC,mBAAmB,GAAGF,SAAS,CAAC;EAC5C;;EAEA,IAAIA,SAAS,KAAK,IAAI,EAAE;IACpB,oBAAOH,OAAA;MAAAM,QAAA,EAAK;IAAU;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAK,CAAC,CAAC,CAAC;EAClC;EACA,MAAMC,sBAAsB,GAAG,MAAAA,CAAA,KAAY;IACvC,IAAI;MACF,MAAMC,GAAG,GAAG,MAAMC,KAAK,CAAC,sCAAsC,CAAC;MAC/D,IAAI,CAACD,GAAG,CAACE,EAAE,EAAE;QACX,MAAM,IAAIC,KAAK,CAAC,uBAAuBH,GAAG,CAACI,MAAM,EAAE,CAAC;MACtD;MACA,MAAMC,IAAI,GAAG,MAAML,GAAG,CAACM,IAAI,CAAC,CAAC;MAC7B,IAAID,IAAI,CAACE,eAAe,EAAE;QACxBC,0BAA0B,CAAC,IAAI,CAAC;MAClC,CAAC,MAAM;QACLC,YAAY,CAACC,UAAU,CAAC,WAAW,CAAC;QACpCC,YAAY,CAAC,KAAK,CAAC;MACrB;IACF,CAAC,CAAC,OAAOC,GAAG,EAAE;MACZpB,OAAO,CAACqB,KAAK,CAAC,iCAAiC,EAAED,GAAG,CAAC;MACrDD,YAAY,CAAC,KAAK,CAAC;IACrB;EACF,CAAC;EAEH,oBACIvB,OAAA;IAAAM,QAAA,EACKH,SAAS,gBAAGH,OAAA,CAACJ,MAAM;MAAAW,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAC,CAAC,gBAAGV,OAAA,CAACH,QAAQ;MAAC6B,EAAE,EAAC;IAAQ;MAAAnB,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAC;EAAC;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAC/C,CAAC;AAEd;AAACR,EAAA,CAhCQD,eAAe;EAAA,QACAH,aAAa;AAAA;AAAA6B,EAAA,GAD5B1B,eAAe;AAiCxB,eAAeA,eAAe;AAAA,IAAA0B,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}