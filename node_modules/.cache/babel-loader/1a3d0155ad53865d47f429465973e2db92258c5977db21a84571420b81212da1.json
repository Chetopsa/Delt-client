{"ast":null,"code":"var _jsxFileName = \"/Users/chestonopsasnick/Documents/Coding_Projects/DeltsDineV2/client/src/utils/ProtectedRoutes.js\";\nimport React, { useEffect, useState } from 'react';\nimport { Outlet, Navigate } from \"react-router-dom\";\nimport { useValidation } from './ValidationContext'; // Import the useValidation hook\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction ProtectedRoutes() {\n  // const {validated} = useValidation();\n  // console.log(\"protected routes \" + validated);\n  // // Handle loading state if validation is still being checked\n\n  // if (validated === null) {\n  //     return <div>Loading...</div>; // replace with loading ui\n  // }\n  let validated = null;\n  try {\n    fetch('http://localhost:3001/api/validation', {\n      method: 'GET',\n      credentials: 'include' // ensure cookies are sent with the request\n    }).then(res => {\n      if (!res.ok) {\n        throw new Error(\"invalid network response\");\n      }\n    }).then(res => res.json());\n    if (!res.ok) {\n      throw new Error(`HTTP error, Status: ${res.status}`);\n    }\n    const data = res.json();\n    if (data.isAuthenticated) {\n      validated = true;\n    } else {\n      validated = false;\n    }\n  } catch (err) {\n    console.error('Error fetching validation data:', err);\n    validated = false;\n  }\n  if (validated === null) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: \"LOADING....\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 40,\n      columnNumber: 16\n    }, this); // wait for fetch request to go through\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: validated ? /*#__PURE__*/_jsxDEV(Outlet, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 44,\n      columnNumber: 26\n    }, this) : /*#__PURE__*/_jsxDEV(Navigate, {\n      to: \"/login\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 44,\n      columnNumber: 38\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 43,\n    columnNumber: 9\n  }, this);\n}\n_c = ProtectedRoutes;\nexport default ProtectedRoutes;\nvar _c;\n$RefreshReg$(_c, \"ProtectedRoutes\");","map":{"version":3,"names":["React","useEffect","useState","Outlet","Navigate","useValidation","jsxDEV","_jsxDEV","ProtectedRoutes","validated","fetch","method","credentials","then","res","ok","Error","json","status","data","isAuthenticated","err","console","error","children","fileName","_jsxFileName","lineNumber","columnNumber","to","_c","$RefreshReg$"],"sources":["/Users/chestonopsasnick/Documents/Coding_Projects/DeltsDineV2/client/src/utils/ProtectedRoutes.js"],"sourcesContent":["import React, {useEffect, useState} from 'react'\nimport { Outlet, Navigate } from \"react-router-dom\";\nimport { useValidation } from './ValidationContext'; // Import the useValidation hook\n\nfunction ProtectedRoutes() {\n    // const {validated} = useValidation();\n    // console.log(\"protected routes \" + validated);\n    // // Handle loading state if validation is still being checked\n\n    // if (validated === null) {\n    //     return <div>Loading...</div>; // replace with loading ui\n    // }\n    let validated = null;\n    try {\n        fetch('http://localhost:3001/api/validation', {\n            method: 'GET',\n            credentials: 'include', // ensure cookies are sent with the request\n        })\n        .then(res => {\n            if (!res.ok) {\n                throw new Error(\"invalid network response\");\n            }\n        }\n            )\n        .then(res =>res.json())   \n        if (!res.ok) {\n        throw new Error(`HTTP error, Status: ${res.status}`);\n        }\n        const data = res.json();\n        if (data.isAuthenticated) {\n            validated = true\n        } else {\n            validated = false\n        }\n    } catch (err) {\n        console.error('Error fetching validation data:', err);\n        validated = false;\n    }\n    if (validated === null) {\n        return <div>LOADING....</div> // wait for fetch request to go through\n    }\n    return (\n        <div>\n            {validated ? <Outlet/> : <Navigate to=\"/login\"/>}\n        </div>\n    )\n}\nexport default ProtectedRoutes"],"mappings":";AAAA,OAAOA,KAAK,IAAGC,SAAS,EAAEC,QAAQ,QAAO,OAAO;AAChD,SAASC,MAAM,EAAEC,QAAQ,QAAQ,kBAAkB;AACnD,SAASC,aAAa,QAAQ,qBAAqB,CAAC,CAAC;AAAA,SAAAC,MAAA,IAAAC,OAAA;AAErD,SAASC,eAAeA,CAAA,EAAG;EACvB;EACA;EACA;;EAEA;EACA;EACA;EACA,IAAIC,SAAS,GAAG,IAAI;EACpB,IAAI;IACAC,KAAK,CAAC,sCAAsC,EAAE;MAC1CC,MAAM,EAAE,KAAK;MACbC,WAAW,EAAE,SAAS,CAAE;IAC5B,CAAC,CAAC,CACDC,IAAI,CAACC,GAAG,IAAI;MACT,IAAI,CAACA,GAAG,CAACC,EAAE,EAAE;QACT,MAAM,IAAIC,KAAK,CAAC,0BAA0B,CAAC;MAC/C;IACJ,CACI,CAAC,CACJH,IAAI,CAACC,GAAG,IAAGA,GAAG,CAACG,IAAI,CAAC,CAAC,CAAC;IACvB,IAAI,CAACH,GAAG,CAACC,EAAE,EAAE;MACb,MAAM,IAAIC,KAAK,CAAC,uBAAuBF,GAAG,CAACI,MAAM,EAAE,CAAC;IACpD;IACA,MAAMC,IAAI,GAAGL,GAAG,CAACG,IAAI,CAAC,CAAC;IACvB,IAAIE,IAAI,CAACC,eAAe,EAAE;MACtBX,SAAS,GAAG,IAAI;IACpB,CAAC,MAAM;MACHA,SAAS,GAAG,KAAK;IACrB;EACJ,CAAC,CAAC,OAAOY,GAAG,EAAE;IACVC,OAAO,CAACC,KAAK,CAAC,iCAAiC,EAAEF,GAAG,CAAC;IACrDZ,SAAS,GAAG,KAAK;EACrB;EACA,IAAIA,SAAS,KAAK,IAAI,EAAE;IACpB,oBAAOF,OAAA;MAAAiB,QAAA,EAAK;IAAW;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAK,CAAC,EAAC;EAClC;EACA,oBACIrB,OAAA;IAAAiB,QAAA,EACKf,SAAS,gBAAGF,OAAA,CAACJ,MAAM;MAAAsB,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAC,CAAC,gBAAGrB,OAAA,CAACH,QAAQ;MAACyB,EAAE,EAAC;IAAQ;MAAAJ,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAC;EAAC;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAC/C,CAAC;AAEd;AAACE,EAAA,GA1CQtB,eAAe;AA2CxB,eAAeA,eAAe;AAAA,IAAAsB,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}